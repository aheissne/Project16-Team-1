<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scafwording - Welcome Ethan</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin: 0;
            padding: 0;
        }
        .header {
            margin-top: 20px;
        }
	.logo {
	    height: 80px; 
	    margin-left: 110px;
	    vertical-align: middle;
	}

        .welcome {
            margin-top: 25px;
        }
        .progress {
	    margin-top: 45px;
            display: flex;
            justify-content: center;
            gap: 150px;
        }
        .progress-circle {
            width: 100px;
            height: 100px;
            background: conic-gradient(#34a853 14%, #e0e0e0 0deg);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }
        .progress-circle::before {
            content: '14 out of 1000 Words Learned';
            color: white;
            font-size: 0.8em;
        }
        .progress-circle:nth-child(2) {
	        background: conic-gradient(#34a853 100%, #e0e0e0 0deg);
        }
        .progress-circle:nth-child(2)::before {
            content: '100% Retention Score';
            color: white;
        }
        .buttons {
            margin: 20px 0;
	    display: flex;
	    justify-content: center;
	    gap: 70px;
        }
        button {
            padding: 10px 20px;
            margin: 0 10px;
            border: none;
            border-radius: 5px;
            background-color: #1a73e8;
            color: white;
            cursor: pointer;
        }
	.learned-words-btn {
	    background-color: #fbbc04; 
	    color: black;
}

	.feedback-button {
	    background-color: #000080 !important;
	    color: white;
	}
        .feedback {
            margin: 40px 0;
            padding: 20px;
            border: 1px solid #e0e0e0;
            border-radius: 5px;
            width: 300px;
            margin-left: auto;
            margin-right: auto;
        }
        .footer {
            margin-top: 40px;
            color: #666;
            font-size: 0.8em;
        }
    </style>
</head>
<body>
    <div class="header">
        <a href="index.html">
	    <img src="assets/gifs/scafwording.jpg" alt="Scafwording Logo" class="logo">
	</a>
        <a href="index.html" style="float: right; padding: 5px 10px; background-color: #1a73e8; color: white; text-decoration: none; border-radius: 5px;">Log out</a>
    </div>
    <div class="welcome">
        <h2>Welcome Ethan,</h2>
        <p>You have learned for 1 consecutive day!</p>
        <div class="progress">
            <div class="progress-circle"></div>
            <div class="progress-circle"></div>
        </div>
        <div class="buttons">
            <a href="learn.html"><button>Learn more words</button></a>
            <a href="quiz.html"><button>Start a Daily Quiz</button></a>
        </div>
        <a href="learned-words.html"><button class="learned-words-btn">View Learned Words</button></a>
    </div>
    <div class="feedback">
        <p>Rate Your Learning Journey</p>
        <button class="feedback-button">Share Feedback</button>
    </div>
    <div class="footer">
        <div>Contact Support: <a href="mailto:support@scafwording.app">support@scafwording.app</a></div>
        <div>Â©2024 Scafwording. All Rights Reserved</div>
    </div>

<script>
(async () => {
  // 1) Load dictionary size for totals
  const WORDS = await fetch('words.json').then(r => r.json()).catch(()=> ({}));
  const TOTAL_DICT = Object.keys(WORDS).length || 10; // fallback

  // 2) Username + greeting
  const name = localStorage.getItem('username') || 'there';
  document.title = 'Scaffwording - Welcome ' + name; // fix spelling in title
  const h2 = document.querySelector('.welcome h2');
  if (h2) h2.textContent = `Welcome ${name},`;

  // 3) Learned words progress
  const learned = JSON.parse(localStorage.getItem('learnedWords') || '[]');
  const learnedCount = learned.length;
  const learnedPct = Math.max(0, Math.min(100, (learnedCount / TOTAL_DICT) * 100));

  // 4) Retention = last quiz score / maxQuestions
  const score = Number(localStorage.getItem('quizScore') || '0');
  const selected = JSON.parse(localStorage.getItem('selectedWordIds') || '[]');
  const maxQ = Number(localStorage.getItem('maxQuestions')) || (selected.length || 5);
  const retentionPct = maxQ ? Math.max(0, Math.min(100, (score / maxQ) * 100)) : 0;

  // 5) Paint the two progress rings and labels
  const rings = document.querySelectorAll('.progress-circle');
  if (rings[0]) {
    rings[0].style.background = `conic-gradient(#34a853 ${learnedPct * 3.6}deg, #e0e0e0 0deg)`;
    rings[0].setAttribute('aria-label', `${learnedCount} of ${TOTAL_DICT} words learned`);
    rings[0].style.position = 'relative';
    rings[0].innerHTML = `<div style="position:absolute;inset:0;display:flex;align-items:center;justify-content:center;color:#000;font-size:.76em;padding:8px;text-align:center;">
      ${learnedCount} of ${TOTAL_DICT} Words Learned
    </div>`;
  }
  if (rings[1]) {
    rings[1].style.background = `conic-gradient(#34a853 ${retentionPct * 3.6}deg, #e0e0e0 0deg)`;
    rings[1].setAttribute('aria-label', `${retentionPct.toFixed(0)}% retention`);
    rings[1].style.position = 'relative';
    rings[1].innerHTML = `<div style="position:absolute;inset:0;display:flex;align-items:center;justify-content:center;color:#000;font-size:.9em;padding:8px;text-align:center;">
      ${retentionPct.toFixed(0)}% Retention
    </div>`;
  }

  // 6) Make the two CTA buttons set up a 10-word session by default
  function setSelection(n = 10) {
    // If you later add a picker, write those IDs here instead of 1..n
    const ids = Array.from({length: Math.min(n, TOTAL_DICT)}, (_, i) => i + 1);
    localStorage.setItem('selectedWordIds', JSON.stringify(ids));
    localStorage.setItem('maxQuestions', String(ids.length));
  }

  // Replace anchor+button nesting with click handlers on anchors
  const learnLink = document.querySelector('a[href="learn.html"]');
  const quizLink  = document.querySelector('a[href="quiz.html"]');

  if (learnLink) {
    learnLink.addEventListener('click', (e) => {
      setSelection(10);             // default to 10
      // optionally start at first learn card
      // window.location.href = 'learn-quiz.html?index=0'; return e.preventDefault();
    });
  }
  if (quizLink) {
    quizLink.addEventListener('click', (e) => {
      setSelection(10);             // default to 10
      // quiz.html will read maxQuestions/selectedWordIds and route to quiz-questions
    });
  }

  // 7) (Nice-to-have) Streak text
  const p = document.querySelector('.welcome p');
  if (p) {
    const days = Number(localStorage.getItem('streakDays') || '1');
    p.textContent = `You have learned for ${days} consecutive ${days === 1 ? 'day' : 'days'}!`;
  }
})();
</script>


</body>
</html>






