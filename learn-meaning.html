<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Scaffolding - Learn Meaning</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background-color: #4a4a4a;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
    }
    .learn-container {
      background-color: white;
      padding: 20px;
      border-radius: 10px;
      text-align: center;
      width: 400px;
    }
    .dialogue { color: #1a73e8; margin-bottom: 20px; }
    .question { font-weight: bold; margin-bottom: 12px; }

    /* GIF hint block */
    #gifHint { margin: 8px 0 18px; }
    #gifHint img {
      max-width: 260px;
      border-radius: 10px;
      display: block;
      margin: 0 auto;
    }
    .hint-controls {
      margin-top: 6px;
      display: flex;
      justify-content: center;
      gap: 8px;
    }
    .hint-btn {
      padding: 6px 10px;
      border: 1px solid #ccc;
      border-radius: 6px;
      background: #fff;
      cursor: pointer;
    }
.hint-toggle {
  margin: 6px 0 12px;
  padding: 6px 10px;
  border: 1px solid #ccc;
  border-radius: 6px;
  background: #fff;
  cursor: pointer;
}

    .options {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      text-align: center;
      padding: 0 20px;
    }
    .option-btn {
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 5px;
      cursor: pointer;
      background-color: white;
      transition: background-color 0.3s;
    }
    .option-btn.correct { background-color: #34a853; color: white; }
    .option-btn.incorrect { background-color: #ea4335; color: white; }
    .option-btn:hover { background-color: #f0f0f0; }
    .option-btn.disabled { cursor: not-allowed; opacity: 0.6; }

    /* Respect reduced motion: hide animated GIF and show still */
    @media (prefers-reduced-motion: reduce) {
      #gifHint img[data-kind="gif"] { display: none; }
      #gifHint img[data-kind="still"] { display: block; }
    }
  </style>
</head>
<body>
  <div class="learn-container">
    <div class="dialogue" id="dialogue"></div>
    <div class="question" id="question"></div>
	<button id="toggleHint" class="hint-btn hint-toggle" aria-expanded="false">Show Gif Hint</button>
	<div id="gifHint" aria-live="polite" hidden></div>


 

    <div class="options" id="options"><!-- Options populated by JS --></div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      let currentIndex = parseInt(new URLSearchParams(window.location.search).get('index')) || 0;
      let currentWord = decodeURIComponent(new URLSearchParams(window.location.search).get('word')) || 'loquacious';

      // Track incorrect words
      let incorrectWords = new Set(JSON.parse(localStorage.getItem('incorrectWords')) || []);

      // Word data (dialogue + MC options)
      const wordData = {
        'cursory': {
          dialogue: 'Mia: He just glanced at the report and moved on. Alex: Yeah, his review was pretty <span id="dynamicWord"></span>!',
          question: '<span id="dynamicWordQuestion"></span> means?',
          options: [
            { text: 'a) Thorough', correct: false },
            { text: 'b) Hasty', correct: true },
            { text: 'c) Detailed', correct: false },
            { text: 'd) Careful', correct: false }
          ]
        },
        'insipid': {
          dialogue: 'Mia: This soup tastes so bland. Alex: I agree, it’s completely <span id="dynamicWord"></span>!',
          question: '<span id="dynamicWordQuestion"></span> means?',
          options: [
            { text: 'a) Flavorful', correct: false },
            { text: 'b) Dull', correct: true },
            { text: 'c) Spicy', correct: false },
            { text: 'd) Rich', correct: false }
          ]
        },
        'loquacious': {
          dialogue: 'Mia: She hasn’t stopped talking since we arrived! Alex: Yes, she’s incredibly <span id="dynamicWord"></span> today.',
          question: '<span id="dynamicWordQuestion"></span> means?',
          options: [
            { text: 'a) Silent', correct: false },
            { text: 'b) Reserved', correct: false },
            { text: 'c) Shy', correct: false },
            { text: 'd) Talkative', correct: true }
          ]
        },
        'flout': {
          dialogue: 'Mia: He ignored the rules again. Alex: Yeah, he loves to <span id="dynamicWord"></span> authority!',
          question: '<span id="dynamicWordQuestion"></span> means?',
          options: [
            { text: 'a) Obey', correct: false },
            { text: 'b) Respect', correct: false },
            { text: 'c) Disregard', correct: true },
            { text: 'd) Follow', correct: false }
          ]
        },
        'serendipity': {
          dialogue: 'Mia: I found this book by chance and loved it! Alex: That’s such a moment of <span id="dynamicWord"></span>!',
          question: '<span id="dynamicWordQuestion"></span> means?',
          options: [
            { text: 'a) Planning', correct: false },
            { text: 'b) Luck', correct: true },
            { text: 'c) Effort', correct: false },
            { text: 'd) Struggle', correct: false }
          ]
        }
      };

      // Simple map of word -> GIF & still image (place files in assets/gifs/)
      const gifMap = {
        'cursory':     { gif: 'assets/gifs/cursory.gif'},
        'insipid':     { gif: 'assets/gifs/insipid.gif'},
        'loquacious':  { gif: 'assets/gifs/loquacious.gif'},
        'flout':       { gif: 'assets/gifs/flout.gif',},
        'serendipity': { gif: 'assets/gifs/serendipity.gif'}
      };

      // Render dialogue + question
      const data = wordData[currentWord] || wordData['loquacious'];
      document.getElementById('dialogue').innerHTML =
        data.dialogue.replace('<span id="dynamicWord"></span>', `<span id="dynamicWord">${currentWord}</span>`);
      document.getElementById('question').innerHTML =
        data.question.replace('<span id="dynamicWordQuestion"></span>', `<span id="dynamicWordQuestion">${currentWord}</span>`);

// Toggle-to-show behavior (paste here)
const toggleBtn = document.getElementById('toggleHint');
const gifContainer = document.getElementById('gifHint');
let hintBuilt = false;

toggleBtn.addEventListener('click', () => {
  const isHidden = gifContainer.hasAttribute('hidden');
  if (isHidden) {
    if (!hintBuilt) { buildGifHint(currentWord); hintBuilt = true; }
    gifContainer.removeAttribute('hidden');
    toggleBtn.textContent = 'Hide Hint';
    toggleBtn.setAttribute('aria-expanded', 'true');
  } else {
    gifContainer.setAttribute('hidden', '');
    toggleBtn.textContent = 'Show Gif Hint';
    toggleBtn.setAttribute('aria-expanded', 'false');
  }
});

      // Render options
      const optionsContainer = document.getElementById('options');
      data.options.forEach(option => {
        const button = document.createElement('button');
        button.className = 'option-btn';
        button.textContent = option.text;
        button.onclick = () => checkAnswer(button, option.text.charAt(0));
        optionsContainer.appendChild(button);
      });

      function checkAnswer(button, selected) {
        const options = document.querySelectorAll('.option-btn');
        const correctOption = data.options.find(opt => opt.correct).text.charAt(0);

        options.forEach(btn => btn.classList.remove('correct', 'incorrect', 'disabled'));

        if (selected === correctOption) {
          button.classList.add('correct', 'disabled');
          if (!incorrectWords.has(currentIndex)) {
            let score = parseInt(localStorage.getItem('quizScore')) || 0;
            score++;
            localStorage.setItem('quizScore', score);
          }
          setTimeout(() => {
            window.location.href = `correct.html?index=${currentIndex}`;
          }, 500);
        } else {
          button.classList.add('incorrect', 'disabled');
          if (!incorrectWords.has(currentIndex)) {
            incorrectWords.add(currentIndex);
            localStorage.setItem('incorrectWords', JSON.stringify([...incorrectWords]));
          }
        }
      }

function buildGifHint(word) {
  const cfg = gifMap[word];
  const container = document.getElementById('gifHint');
  container.innerHTML = '';

  if (!cfg) {
    container.textContent = 'No hint available.';
    return;
  }

  // Preload so we only insert if it actually loads
  function preload(src) {
    return new Promise((resolve, reject) => {
      if (!src) return reject('no-src');
      const img = new Image();
      img.onload = () => resolve(src);
      img.onerror = () => reject(src);
      img.src = src;
    });
  }

  preload(cfg.gif)
    .then((gifSrc) => {
      const gif = document.createElement('img');
      gif.src = gifSrc;
      gif.alt = `${word} visual hint (animated)`;
      gif.setAttribute('data-kind', 'gif');
      styleHintImage(gif);
      container.appendChild(gif);

      // Simple Pause/Play (hide/show the same GIF)
      const controls = document.createElement('div');
      controls.className = 'hint-controls';

      const btn = document.createElement('button');
      btn.className = 'hint-btn';
      btn.textContent = 'Pause';
      btn.onclick = (e) => {
        e.stopPropagation();
        const paused = gif.style.visibility === 'hidden';
        if (paused) {
          gif.style.visibility = 'visible';
          btn.textContent = 'Pause';
        } else {
          gif.style.visibility = 'hidden';
          btn.textContent = 'Play';
        }
      };

      controls.appendChild(btn);
      container.appendChild(controls);
    })
    .catch(() => {
      container.innerHTML =
        `<div style="color:#666;font-size:.9em">Couldn’t load hint. Check file: <code>${cfg.gif}</code></div>`;
    });

  function styleHintImage(img) {
    img.style.maxWidth = '260px';
    img.style.borderRadius = '10px';
    img.style.display = 'block';
    img.style.margin = '10px auto 0';
  }
}
    });
  </script>
</body>
</html>
